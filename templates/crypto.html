{% extends "index.html" %}

{% block extra_styles %}
<style>
    .crypto-buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
    }

    .crypto-button {
        padding: 8px 16px;
        font-size: 14px;
        cursor: pointer;
        background-color: #f0f0f0;
        border: none;
        border-radius: 20px;
        color: #333;
        transition: all 0.3s;
    }

    .crypto-button.active {
        background-color: #4CAF50;
        color: white;
    }

    .chart-container {
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: white;
    }

    .indicator-section {
        margin-top: 20px;
        display: flex;
        justify-content: flex-start;
    }

    .indicator-toggle {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: #f8f9fa;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.3s;
        width: fit-content;
    }

    .indicator-toggle:hover {
        background-color: #e9ecef;
    }

    .indicator-toggle.active {
        background-color: #4CAF50;
        color: white;
    }

    .toggle-circle {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        border: 2px solid #666;
        display: inline-block;
        margin-right: 8px;
    }

    .active .toggle-circle {
        background-color: white;
        border-color: white;
    }

    .alert-section {
        margin-top: 20px;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 8px;
    }

    .alert-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    #newsReportBtn, #athBtn, #goldenCrossBtn {
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
        transition: background-color 0.3s;
    }

    #newsReportBtn:hover, #athBtn:hover, #goldenCrossBtn:hover {
        background-color: #45a049;
    }
</style>
{% endblock %}

{% block content %}
<div class="crypto-buttons">
    <button class="crypto-button" onclick="window.location.href='/crypto/bitcoin'">Bitcoin</button>
    <button class="crypto-button" onclick="window.location.href='/crypto/ethereum'">Ethereum</button>
    <button class="crypto-button" onclick="window.location.href='/crypto/ripple'">Ripple</button>
</div>

<div class="chart-container">
    {{ chart | safe }}
</div>

<div class="indicator-section">
    <div class="indicator-toggle" onclick="toggleMVRV(this)">
        <input type="checkbox" id="mvrv-checkbox" style="display: none;">
        <span class="toggle-circle"></span>
        <span>MVRV Z-Score</span>
    </div>
</div>

<div class="alert-section">
    <h2 style="margin: 20px 0; color: #333;">Alert</h2>
    <div class="alert-buttons">
        <button class="crypto-button" id="newsReportBtn">News Report</button>
        <button class="crypto-button" id="athBtn">All-time High</button>
        <button class="crypto-button" id="goldenCrossBtn">Golden Cross</button>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
function toggleMVRV(element) {
    const checkbox = document.getElementById('mvrv-checkbox');
    checkbox.checked = !checkbox.checked;
    element.classList.toggle('active');
    
    const currentUrl = window.location.pathname;
    const baseUrl = currentUrl.split('?')[0];
    
    if (checkbox.checked) {
        window.location.href = `${baseUrl}?mvrv=true`;
    } else {
        window.location.href = baseUrl;
    }
}

// URL에서 mvrv 파라미터를 확인하여 체크박스 상태 설정
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const mvrv = urlParams.get('mvrv');
    if (mvrv === 'true') {
        document.getElementById('mvrv-checkbox').checked = true;
        document.querySelector('.indicator-toggle').classList.add('active');
    }
});
</script>
{% endblock %} 